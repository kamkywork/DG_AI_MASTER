<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI MASTER V.7 PRO - ภาษาไทย</title>
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@400;600;700&family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg-body: #050505; --bg-card: #121212; --primary: #ffd700; --p-color: #2196f3; --b-color: #ff1744; --t-color: #43a047; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Sarabun', sans-serif; }
        body { background-color: var(--bg-body); color: #fff; margin: 0; display: flex; justify-content: center; }
        .app-frame { width: 100%; max-width: 480px; background: var(--bg-card); min-height: 100vh; display: flex; flex-direction: column; border: 1px solid #333; position: relative; }
        
        /* หัวข้อ */
        .header { padding: 15px; background: #1a1a1a; border-bottom: 2px solid var(--primary); text-align: center; }
        .logo { font-family: 'Teko'; font-size: 2rem; font-weight: 700; letter-spacing: 2px; }
        .logo span { color: var(--primary); }
        .server-select { width: 100%; padding: 12px; background: #000; border: 1px solid #444; color: #fff; border-radius: 8px; margin-top: 10px; font-weight: 600; }

        .content { padding: 15px; flex: 1; padding-bottom: 140px; }
        
        /* การ์ดวิเคราะห์ AI */
        .ai-card { background: linear-gradient(145deg, #1a1a1a, #0a0a0a); border-radius: 20px; padding: 25px; text-align: center; border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        .ai-result { font-family: 'Teko'; font-size: 5rem; font-weight: 700; line-height: 1; margin: 10px 0; letter-spacing: 3px; }
        .c-p { color: var(--p-color); text-shadow: 0 0 15px rgba(33,150,243,0.5); }
        .c-b { color: var(--b-color); text-shadow: 0 0 15px rgba(255,23,68,0.5); }
        .c-w { color: #555; }
        
        .bar-bg { background: rgba(255,255,255,0.05); height: 10px; border-radius: 5px; margin: 15px 0; overflow: hidden; }
        .bar-fill { height: 100%; width: 0%; transition: width 0.8s cubic-bezier(0.1, 0.7, 1.0, 0.1); background: var(--primary); }

        /* ข้อมูลเงินเดิมพัน */
        .money-box { background: rgba(255,255,255,0.03); border-radius: 12px; padding: 15px; margin-top: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; border: 1px solid #222; }
        .m-label { font-size: 0.75rem; color: #888; }
        .m-val { font-family: 'Teko'; font-size: 2.2rem; font-weight: 600; }

        /* ตาราง Big Road */
        .road-header { font-size: 0.8rem; color: #666; margin: 15px 0 5px 5px; font-weight: 600; }
        .grid-container { background: #000; border-radius: 10px; padding: 5px; overflow-x: auto; border: 1px solid #222; }
        .grid-table { border-collapse: collapse; }
        .g-cell { width: 26px; height: 26px; border: 1px solid #111; position: relative; }
        
        /* เม็ดสีในตาราง */
        .bead { width: 20px; height: 20px; border-radius: 50%; margin: auto; position: relative; }
        .bd-p { background: var(--p-color); }
        .bd-b { background: var(--b-color); }
        /* สัญลักษณ์เสมอ (ขีดเขียว) */
        .tie-slash { 
            position: absolute; width: 100%; height: 2px; background: #00e676; 
            top: 50%; left: 0; transform: rotate(-45deg); box-shadow: 0 0 3px #000;
            z-index: 10;
        }

        /* ปุ่มควบคุม */
        .controls { position: fixed; bottom: 0; left: 0; right: 0; max-width: 480px; margin: 0 auto; background: #0a0a0a; padding: 12px; border-top: 1px solid #333; box-shadow: 0 -5px 20px rgba(0,0,0,0.5); }
        .btn-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .btn { border: none; border-radius: 12px; padding: 12px 0; font-family: 'Teko'; font-size: 1.8rem; color: #fff; cursor: pointer; transition: 0.1s; font-weight: 700; }
        .btn-p { background: var(--p-color); border-bottom: 4px solid #0d47a1; }
        .btn-t { background: var(--t-color); border-bottom: 4px solid #1b5e20; }
        .btn-b { background: var(--b-color); border-bottom: 4px solid #b71c1c; }
        .btn:active { transform: translateY(2px); border-bottom-width: 0; }
        .sub-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .sub-btn { padding: 10px; background: #222; color: #aaa; border: 1px solid #333; border-radius: 8px; font-size: 0.9rem; font-weight: 600; }
    </style>
</head>
<body>
<div class="app-frame">
    <header class="header">
        <div class="logo">AI MASTER <span>V.7 PRO</span></div>
        <select id="providerSelect" class="server-select" onchange="analyze()">
            <option value="sa">เซิร์ฟเวอร์ 1: SA GAMING (ดักมังกร)</option>
            <option value="sexy">เซิร์ฟเวอร์ 2: AE SEXY (ดักปิงปอง)</option>
            <option value="dg">เซิร์ฟเวอร์ 3: DREAM GAMING (สมดุล)</option>
        </select>
    </header>

    <main class="content">
        <div style="display:flex; justify-content:space-between; margin-bottom:12px;">
            <div style="background:#151515; padding:8px 15px; border-radius:10px; width:48%;">
                <div class="m-label">กำไรสะสม</div>
                <div id="profitVal" style="font-family:'Teko'; font-size:1.6rem; color:#00e676;">0</div>
            </div>
            <div style="background:#151515; padding:8px 15px; border-radius:10px; width:48%; text-align:right;">
                <div class="m-label">สถานะไม้ล่าสุด</div>
                <div id="lastResTxt" style="font-weight:700;">-</div>
            </div>
        </div>

        <div class="ai-card">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <span style="font-size:0.8rem; font-weight:700; color:#666;">ประมวลผลด้วยระบบ AI </span>
                <span id="aiConfTxt" style="font-family:'Teko'; color:var(--primary); font-size:1.4rem;">0%</span>
            </div>
            <div id="aiResult" class="ai-result c-w">รอข้อมูล</div>
            <div class="bar-bg"><div id="confBar" class="bar-fill"></div></div>
            <div id="aiReason" style="font-size:0.85rem; color:#888;">กรุณาใส่ข้อมูลอย่างน้อย 6 ตา...</div>

            <div class="money-box">
                <div>
                    <div class="m-label">จำนวนที่ต้องลง (BET)</div>
                    <div class="m-val" id="nextBetTxt" style="color:var(--primary);">100</div>
                </div>
                <div style="text-align:right;">
                    <div class="m-label">ระบบเดินเงิน</div>
                    <div id="stepNameTxt" style="font-size:1rem; font-weight:700; margin-top:10px;">ไม้ที่ 1</div>
                </div>
            </div>
        </div>

        <div class="road-header">ประวัติเค้าไพ่หลัก (BIG ROAD)</div>
        <div class="grid-container" id="bigRoad"></div>
    </main>

    <footer class="controls">
        <div class="btn-row">
            <button class="btn btn-p" onclick="addRes('P')">PLAYER</button>
            <button class="btn btn-t" onclick="addRes('T')">TIE</button>
            <button class="btn btn-b" onclick="addRes('B')">BANKER</button>
        </div>
        <div class="sub-row">
            <button class="sub-btn" onclick="undo()">ย้อนกลับ (Undo)</button>
            <button class="sub-btn" onclick="resetGame()">เริ่มใหม่ (Reset)</button>
        </div>
    </footer>
</div>

<script>
    let history = []; // เก็บประวัติทั้งหมด
    let balance = 0;
    let betStep = 0;
    let lastPred = null;

    // ระบบเดินเงิน Martingale 5 ไม้ (100, 200, 400, 800, 1600)
    const martSteps = [1, 2, 4, 8, 16];

    function addRes(v) {
        // คิดคำนวณเงิน
        if (lastPred && v !== 'T') {
            const betAmount = 100 * martSteps[betStep];
            if (v === lastPred) {
                // ชนะ
                balance += (v === 'B' ? betAmount * 0.95 : betAmount);
                document.getElementById('lastResTxt').innerText = "WIN ✓";
                document.getElementById('lastResTxt').style.color = "#00e676";
                betStep = 0; // กลับไปเริ่มไม้ 1
            } else {
                // แพ้
                balance -= betAmount;
                document.getElementById('lastResTxt').innerText = "LOSE ✗";
                document.getElementById('lastResTxt').style.color = "#ff1744";
                betStep++; // ทบไม้
                if (betStep >= martSteps.length) betStep = 0; // แตกแล้วเริ่มใหม่
            }
        }
        
        history.push(v);
        updateUI();
        analyze();
    }

    function generateBigRoad(data) {
        let matrix = [];
        if (!data.length) return matrix;

        let currentCol = [];
        let lastColor = null;

        data.forEach(v => {
            if (v === 'T') {
                // ถ้าเป็นเสมอ ให้เพิ่มข้อมูลเข้าไปในเม็ดล่าสุดของคอลัมน์ปัจจุบัน
                if (currentCol.length > 0) {
                    let lastItem = currentCol[currentCol.length - 1];
                    lastItem.ties = (lastItem.ties || 0) + 1;
                } else {
                    // ถ้าเสมอมาเป็นเม็ดแรกของห้อง
                    currentCol.push({ type: 'T', ties: 1 });
                }
            } else {
                if (v === lastColor) {
                    currentCol.push({ type: v, ties: 0 });
                } else {
                    if (currentCol.length > 0) matrix.push(currentCol);
                    currentCol = [{ type: v, ties: 0 }];
                    lastColor = v;
                }
            }
        });
        if (currentCol.length > 0) matrix.push(currentCol);
        return matrix;
    }

    function updateUI() {
        // แสดงผลเงินและกำไร
        document.getElementById('profitVal').innerText = Math.floor(balance).toLocaleString();
        document.getElementById('profitVal').style.color = balance >= 0 ? "#00e676" : "#ff1744";
        
        const currentBet = 100 * martSteps[betStep];
        document.getElementById('nextBetTxt').innerText = currentBet.toLocaleString();
        document.getElementById('stepNameTxt').innerText = "ไม้ที่ " + (betStep + 1);
        document.getElementById('stepNameTxt').style.color = betStep > 0 ? "#ff1744" : "#00e676";

        // วาด Big Road แบบเว็บจริง
        const container = document.getElementById('bigRoad');
        container.innerHTML = '';
        const bigRoad = generateBigRoad(history);
        const tbl = document.createElement('table'); tbl.className = 'grid-table';
        
        for (let r = 0; r < 6; r++) {
            const tr = document.createElement('tr');
            for (let c = 0; c < Math.max(18, bigRoad.length + 1); c++) {
                const td = document.createElement('td'); td.className = 'g-cell';
                if (bigRoad[c] && bigRoad[c][r]) {
                    const item = bigRoad[c][r];
                    const d = document.createElement('div');
                    d.className = `bead bd-${item.type.toLowerCase()}`;
                    
                    // ถ้ามีเสมอ ให้วาดขีดสีเขียว
                    if (item.ties > 0) {
                        const slash = document.createElement('div');
                        slash.className = 'tie-slash';
                        d.appendChild(slash);
                    }
                    td.appendChild(d);
                }
                tr.appendChild(td);
            }
            tbl.appendChild(tr);
        }
        container.appendChild(tbl);
        container.scrollLeft = container.scrollWidth;
    }

    function analyze() {
        const filtered = history.filter(x => x !== 'T');
        if (filtered.length < 6) return;

        // Predictor Logic: จำลองผลล่วงหน้า
        const pWeight = calculateWeight('P', filtered);
        const bWeight = calculateWeight('B', filtered);

        let total = pWeight + bWeight + 0.1;
        let pConf = (pWeight / total) * 100;
        let bConf = (bWeight / total) * 100;
        
        const conf = Math.max(pConf, bConf);
        document.getElementById('aiConfTxt').innerText = conf.toFixed(0) + "%";
        document.getElementById('confBar').style.width = conf + "%";

        const resEl = document.getElementById('aiResult');
        if (Math.abs(pConf - bConf) < 12) {
            lastPred = null;
            resEl.innerText = "รอจังหวะ"; resEl.className = "ai-result c-w";
            document.getElementById('aiReason').innerText = "เค้าไพ่สวิงสูง แนะนำให้รอสูตรนิ่ง";
        } else if (pConf > bConf) {
            lastPred = 'P';
            resEl.innerText = "PLAYER"; resEl.className = "ai-result c-p";
            document.getElementById('aiReason').innerText = "วิเคราะห์พบเค้าไพ่ไหลเข้าทางฝั่งน้ำเงิน";
        } else {
            lastPred = 'B';
            resEl.innerText = "BANKER"; resEl.className = "ai-result c-b";
            document.getElementById('aiReason').innerText = "วิเคราะห์พบเค้าไพ่ไหลเข้าทางฝั่งแดง";
        }
    }

    function calculateWeight(side, data) {
        let sim = [...data, side];
        let road = generateBigRoad(sim);
        let weight = 0;
        const last = road.length - 1;
        
        // กฎ 3 เกลอจำลอง
        if (last >= 1) {
            if (road[last].length === road[last-1].length) weight += 25;
            if (road[last].length === 1) weight += 10;
        }
        return weight;
    }

    function undo() { history.pop(); updateUI(); analyze(); }
    function resetGame() { if(confirm("ต้องการล้างข้อมูลทั้งหมดหรือไม่?")) location.reload(); }
    
    updateUI();
</script>
</body>
</html>